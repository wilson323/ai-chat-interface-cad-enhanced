# 注释开发规范与流程文档

- 目标：提高可读性与可维护性，降低心智负担，支撑审查与自动化。
- 范畴：TypeScript/React/Next.js/Node 边界清晰，遵循 Clean Architecture。

## 基本原则
- 必要即充分：仅为复杂/非直觉的代码添加注释；解释“为什么”，少写“是什么”。
- 结构优先：文件顶部加模块职责简述；复杂函数添加 JSDoc。
- 一致性：统一语义、统一术语、统一英文/中文标点（代码内优先英文）。

## JSDoc 模板
- 函数（复杂或公共导出）：
```ts
/**
 * 功能/意图（Why）
 * 关键约束/边界条件
 * 错误处理与降级策略
 * @param foo 描述
 * @returns 描述
 */
export const doSomething = (foo: string): Result => { /* ... */ }
```
- 类/服务：职责、线程/并发模型、资源生命周期（init/dispose）。
- API Route：请求/响应契约、限流/超时/鉴权说明。

## 错误处理与日志
- try-catch 需包含明确的上下文信息；使用统一 logger；避免吞错。
- 对外暴露稳定错误码/文案；内部保留栈与上下文。

## Clean Architecture 映射
- UI 层：纯渲染与交互，不含业务规则。
- 应用层：用例编排、流程控制、错误边界。
- 领域层：核心模型与规则，纯函数化优先。
- 基础设施：外部系统集成（DB/缓存/HTTP/文件）。

## 文档化要求
- 新模块/重要修改：PR 必须更新对应 docs/ 指南或在此文档追加章节。
- 在代码内添加“变更缘由”块，注明变更背景与兼容性影响。

## 审查清单（片段）
- 命名是否表达意图且一致（camelCase、命名导出）。
- 是否存在多余注释/过期注释。
- 是否覆盖边界与异常路径；是否提供降级策略。
- 是否违背无 mock 原则；是否具备可测试性（依赖可替换）。


