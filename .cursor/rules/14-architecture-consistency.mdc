---
alwaysApply: true
---
# 架构一致性强制规则

本规则对整个代码库生效，要求所有改动符合《架构一致性指引》：
[docs/架构一致性指引.md](mdc:docs/架构一致性指引.md)

## 强制要求
- 遵循 Clean Architecture 分层与依赖方向；UI 不直接访问基础设施。
- 所有 AI 能力必须经过统一适配器与 OpenAI 兼容协议；严禁直连模型 SDK。
- 禁止 mock 数据/服务混入生产逻辑；测试亦尽量使用真实最小化环境。
- 错误处理、重试、缓存、降级、日志须使用统一设施。
- 变更需同步更新关联文档并添加“变更缘由”。

## 审查要点
- 是否突破分层边界？
- 是否重复实现现有能力？
- 是否遗漏异常路径与用户可理解的错误文案？

